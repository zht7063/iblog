# é…ç½®ç³»ç»Ÿé›†æˆå®ŒæˆæŠ¥å‘Š

## å®æ–½æ‘˜è¦

å·²æˆåŠŸä¸º iblog é¡¹ç›®é›†æˆåŸºäº Pydantic çš„å®Œæ•´é…ç½®ç³»ç»Ÿï¼Œä½¿ `config.yaml` ä¸­çš„æ‰€æœ‰é…ç½®é¡¹åœ¨æ„å»ºé™æ€ç«™ç‚¹æ—¶ç”Ÿæ•ˆã€‚

## å®æ–½å†…å®¹

### 1. ä¾èµ–ç®¡ç†
- âœ… æ·»åŠ  `pyyaml>=6.0` åˆ° `pyproject.toml`
- âœ… é¡¹ç›®å·²æœ‰ `pydantic>=2.12.5`

### 2. é…ç½®æ¨¡å‹ (`src/iblog/core/config_models.py`)
åˆ›å»ºäº†å®Œæ•´çš„ Pydantic é…ç½®æ¨¡å‹ï¼ŒåŒ…æ‹¬ï¼š

- **SiteConfig**: ç«™ç‚¹åŸºç¡€ä¿¡æ¯ï¼ˆæ ‡é¢˜ã€å‰¯æ ‡é¢˜ã€ä½œè€…ã€èµ·å§‹æ—¥æœŸç­‰ï¼‰
- **NavigationConfig**: å¯¼èˆªæ é…ç½®ï¼ˆæ”¯æŒè‡ªå®šä¹‰å¯¼èˆªé¡¹ï¼‰
- **FooterConfig**: é¡µè„šé…ç½®ï¼ˆç‰ˆæƒä¿¡æ¯ã€ç¤¾äº¤é“¾æ¥ã€æ˜¾ç¤ºå¼€å…³ï¼‰
- **ThemeConfig**: ä¸»é¢˜é…ç½®
  - ThemeColorsConfig: é¢œè‰²é…ç½®
  - ThemeLayoutConfig: å¸ƒå±€é…ç½®
  - ThemeFontsConfig: å­—ä½“é…ç½®
  - ThemeCDNConfig: CDN èµ„æºé…ç½®
- **FeaturesConfig**: åŠŸèƒ½å¼€å…³ï¼ˆæ§åˆ¶å„ç”Ÿæˆå™¨å¯ç”¨/ç¦ç”¨ï¼‰
- **PathsConfig**: è¾“å‡ºè·¯å¾„é…ç½®
- **PostsConfig**: æ–‡ç« é…ç½®ï¼ˆæ’åºã€é»˜è®¤å€¼ã€æ‘˜è¦ï¼‰
- **LoggingConfig**: æ—¥å¿—é…ç½®
- **BuildConfig**: æ„å»ºé…ç½®
- **Config**: æ ¹é…ç½®æ¨¡å‹ï¼ˆæ•´åˆæ‰€æœ‰å­é…ç½®ï¼‰

ç‰¹ç‚¹ï¼š
- ç±»å‹å®‰å…¨ï¼Œå®Œæ•´çš„ç±»å‹æç¤º
- è‡ªåŠ¨éªŒè¯é…ç½®é¡¹
- æ”¯æŒé»˜è®¤å€¼
- ä½¿ç”¨ Literal ç±»å‹çº¦æŸæšä¸¾å€¼

### 3. é…ç½®åŠ è½½å™¨ (`src/iblog/core/config_loader.py`)
- ä» YAML æ–‡ä»¶åŠ è½½é…ç½®
- ä½¿ç”¨ Pydantic è‡ªåŠ¨éªŒè¯
- æä¾›æ¸…æ™°çš„é”™è¯¯æç¤º
- æ”¯æŒä»å½“å‰å·¥ä½œç›®å½•æˆ–æŒ‡å®šè·¯å¾„åŠ è½½

### 4. CLI æ„å»ºå‘½ä»¤æ›´æ–° (`src/iblog/cli/build.py`)
- æ„å»ºå¼€å§‹æ—¶åŠ è½½é…ç½®
- å°†é…ç½®ä¼ é€’ç»™æ‰€æœ‰ç»„ä»¶
- æ ¹æ® `config.features.generators` æ¡ä»¶æ‰§è¡Œç”Ÿæˆå™¨
- æ„å»ºå®Œæˆä¿¡æ¯ä½¿ç”¨é…ç½®çš„è·¯å¾„

### 5. æ ¸å¿ƒç»„ä»¶æ›´æ–°

#### MetadataParser (`src/iblog/core/metadata_parser.py`)
- æ¥æ”¶ Config å‚æ•°
- ä½¿ç”¨é…ç½®ä¸­çš„é»˜è®¤åˆ†ç±»ã€æ ‡ç­¾ã€ä½œè€…

#### FileScanner (`src/iblog/core/file_scanner.py`)
- æ¥æ”¶ Config å‚æ•°
- æ’åºæ–¹å¼ä½¿ç”¨ `config.posts.sort.by` å’Œ `config.posts.sort.order`
- æ”¯æŒæŒ‰æ—¥æœŸã€æ›´æ–°æ—¥æœŸæˆ–æ ‡é¢˜æ’åº

#### TemplateRenderer (`src/iblog/core/template_renderer.py`)
- æ¥æ”¶ Config å‚æ•°
- `_get_nav_links()`: ä»é…ç½®ç”Ÿæˆå¯¼èˆªæˆ–ä½¿ç”¨é»˜è®¤å¯¼èˆª
- `_get_global_context()`: è¿”å›å…¨å±€é…ç½®ä¸Šä¸‹æ–‡ï¼ˆsite, footer, theme, navigationï¼‰
- æ‰€æœ‰ render æ–¹æ³•æ³¨å…¥å…¨å±€é…ç½®
- ä½¿ç”¨ `model_dump()` å°† Pydantic æ¨¡å‹è½¬ä¸ºå­—å…¸

### 6. ç”Ÿæˆå™¨æ›´æ–°

#### BaseGenerator (`src/iblog/generators/base_generator.py`)
- æ¥æ”¶ Config å‚æ•°

#### PostGenerator (`src/iblog/generators/post_generator.py`)
- ä½¿ç”¨ `config.paths.output.posts` ä½œä¸ºè¾“å‡ºç›®å½•

#### IndexGenerator (`src/iblog/generators/index_generator.py`)
- URL ä½¿ç”¨é…ç½®çš„ posts è·¯å¾„

#### CategoryGenerator (`src/iblog/generators/category_generator.py`)
- ä½¿ç”¨ `config.paths.output.categories` ä½œä¸ºè¾“å‡ºç›®å½•
- é»˜è®¤åˆ†ç±»ä½¿ç”¨é…ç½®å€¼

#### TagGenerator (`src/iblog/generators/tag_generator.py`)
- ä½¿ç”¨ `config.paths.output.tags` ä½œä¸ºè¾“å‡ºç›®å½•

#### AboutGenerator (`src/iblog/generators/about_generator.py`)
- ä½¿ç”¨ `config.paths.output.about` ä½œä¸ºè¾“å‡ºç›®å½•

### 7. æ¨¡æ¿æ›´æ–° (`templates/_base.html`)

**æ›¿æ¢çš„ç¡¬ç¼–ç å†…å®¹ï¼š**

| åŸç¡¬ç¼–ç  | ç°åœ¨ä½¿ç”¨çš„é…ç½®å˜é‡ |
|---------|------------------|
| `Ê•â€¢á´¥â€¢Ê” Iris` | `{{ site.title }}` |
| `Sky is Your Limit.` | `{{ site.subtitle }}` |
| å›ºå®šå¯¼èˆªé“¾æ¥ | `{% for item in navigation %}` å¾ªç¯ |
| å›ºå®šé¡µè„šç‰ˆæƒ | `{{ footer.copyright }}` |
| å›ºå®šç¤¾äº¤é“¾æ¥ | `{% for link in footer.social_links %}` å¾ªç¯ |
| å›ºå®šé¢œè‰²å€¼ | `{{ theme.colors.* }}` |
| å›ºå®šå¸ƒå±€å€¼ | `{{ theme.layout.* }}` |
| `'2026-02-13'` | `{{ site.start_date }}` |

**æ–°å¢åŠŸèƒ½ï¼š**
- å¯¼èˆªæ”¯æŒæ˜¾ç¤ºå›¾æ ‡ï¼ˆ`{{ item.icon }}`ï¼‰
- é¡µè„šå„éƒ¨åˆ†æ”¯æŒå¼€å…³æ§åˆ¶ï¼ˆ`footer.show_*`ï¼‰
- ä¸»é¢˜é¢œè‰²å®Œå…¨å¯é…ç½®
- å¸ƒå±€å‚æ•°ï¼ˆå®½åº¦ã€å†…è¾¹è·ï¼‰å¯é…ç½®

## é…ç½®æ–‡ä»¶è¦†ç›–èŒƒå›´

`config.yaml` ç°åœ¨å®Œå…¨æ§åˆ¶ä»¥ä¸‹æ‰€æœ‰æ–¹é¢ï¼š

- âœ… ç«™ç‚¹ä¿¡æ¯ï¼ˆæ ‡é¢˜ã€å‰¯æ ‡é¢˜ã€ä½œè€…ã€æè¿°ã€è¯­è¨€ã€æ—¶åŒºã€URLï¼‰
- âœ… å¯¼èˆªæ ï¼ˆè‡ªå®šä¹‰å¯¼èˆªé¡¹ã€é“¾æ¥ã€å›¾æ ‡ï¼‰
- âœ… é¡µè„šï¼ˆç‰ˆæƒã€ç¤¾äº¤é“¾æ¥ã€æ˜¾ç¤ºå¼€å…³ï¼‰
- âœ… ä¸»é¢˜æ ·å¼ï¼ˆé¢œè‰²ã€å­—ä½“ã€å¸ƒå±€ã€CDNï¼‰
- âœ… è¾“å‡ºè·¯å¾„ï¼ˆè‡ªå®šä¹‰æ‰€æœ‰è¾“å‡ºç›®å½•åç§°ï¼‰
- âœ… åŠŸèƒ½å¼€å…³ï¼ˆæ§åˆ¶å„ç”Ÿæˆå™¨å¯ç”¨/ç¦ç”¨ï¼‰
- âœ… æ–‡ç« é…ç½®ï¼ˆæ’åºæ–¹å¼ã€é»˜è®¤å€¼ã€æ‘˜è¦è®¾ç½®ï¼‰
- âœ… æ—¥å¿—é…ç½®ï¼ˆçº§åˆ«ã€æ ¼å¼ã€è¾“å‡ºï¼‰
- âœ… æ„å»ºé…ç½®ï¼ˆæ¸…ç†ã€å¤åˆ¶èµ„æºã€æ’é™¤è§„åˆ™ï¼‰

## ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨

```yaml
# config.yaml
site:
  title: "æˆ‘çš„åšå®¢"
  subtitle: "è®°å½•æŠ€æœ¯ä¸ç”Ÿæ´»"
  author: "å¼ ä¸‰"
  start_date: "2026-01-01"

theme:
  colors:
    background: "#ffffff"
    text: "#333333"
    link: "#0066cc"

features:
  generators:
    index: true
    posts: true
    categories: true
    tags: false  # ç¦ç”¨æ ‡ç­¾åŠŸèƒ½
    about: true

paths:
  output:
    posts: "articles"  # è‡ªå®šä¹‰è¾“å‡ºç›®å½•
    categories: "cats"
```

### è‡ªå®šä¹‰å¯¼èˆª

```yaml
navigation:
  items:
    - name: "é¦–é¡µ"
      url: "/"
      icon: "ğŸ "
    - name: "åšå®¢"
      url: "/articles/"
      icon: "ğŸ“"
    - name: "GitHub"
      url: "https://github.com/username"
      icon: "ğŸ”—"
```

### æ–‡ç« æ’åº

```yaml
posts:
  sort:
    by: "updated"  # date | updated | title
    order: "desc"  # desc | asc
  defaults:
    category: "éšç¬”"
    tags: ["æœªåˆ†ç±»"]
    author: "å¼ ä¸‰"
```

## æŠ€æœ¯ä¼˜åŠ¿

### 1. ç±»å‹å®‰å…¨
- IDE å®Œæ•´çš„ä»£ç è¡¥å…¨å’Œç±»å‹æ£€æŸ¥
- ç¼–è¯‘æ—¶å‘ç°ç±»å‹é”™è¯¯
- `config.site.title` æ¯” `config['site']['title']` æ›´å®‰å…¨

### 2. è‡ªåŠ¨éªŒè¯
- Pydantic è‡ªåŠ¨éªŒè¯é…ç½®æ ¼å¼
- æ¸…æ™°çš„é”™è¯¯æç¤º
- Literal ç±»å‹çº¦æŸæšä¸¾å€¼ï¼ˆå¦‚æ’åºå­—æ®µåªèƒ½æ˜¯ "date" | "updated" | "title"ï¼‰

### 3. é»˜è®¤å€¼ç®¡ç†
- ä½¿ç”¨ Field ä¼˜é›…å¤„ç†å¯é€‰é…ç½®
- ç¼ºå¤±é…ç½®é¡¹è‡ªåŠ¨ä½¿ç”¨é»˜è®¤å€¼
- å‘åå…¼å®¹

### 4. å¯ç»´æŠ¤æ€§
- é…ç½®æ¨¡å‹å³æ–‡æ¡£
- ç»“æ„æ¸…æ™°ï¼Œæ˜“äºæ‰©å±•
- æ‰€æœ‰é…ç½®é›†ä¸­ç®¡ç†

## æµ‹è¯•å»ºè®®

ç”¨æˆ·å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æµ‹è¯•é…ç½®ç³»ç»Ÿï¼š

1. **ä¿®æ”¹ç«™ç‚¹ä¿¡æ¯**ï¼šç¼–è¾‘ `config.yaml` ä¸­çš„ `site` éƒ¨åˆ†ï¼Œè¿è¡Œæ„å»ºæŸ¥çœ‹æ•ˆæœ
2. **è‡ªå®šä¹‰é¢œè‰²**ï¼šä¿®æ”¹ `theme.colors`ï¼ŒéªŒè¯æ ·å¼å˜åŒ–
3. **ç¦ç”¨åŠŸèƒ½**ï¼šè®¾ç½® `features.generators.tags: false`ï¼ŒéªŒè¯æ ‡ç­¾é¡µä¸ç”Ÿæˆ
4. **æ›´æ”¹è·¯å¾„**ï¼šä¿®æ”¹ `paths.output.posts: "articles"`ï¼ŒéªŒè¯è¾“å‡ºç›®å½•å˜åŒ–
5. **è‡ªå®šä¹‰å¯¼èˆª**ï¼šæ·»åŠ  `navigation` é…ç½®ï¼ŒéªŒè¯å¯¼èˆªæ å˜åŒ–
6. **é…ç½®éªŒè¯**ï¼šæ•…æ„å†™é”™é…ç½®ï¼ˆå¦‚ `sort.by: "invalid"`ï¼‰ï¼ŒéªŒè¯é”™è¯¯æç¤º

## åç»­æ‰©å±•å»ºè®®

é…ç½®ç³»ç»Ÿå·²ç»ä¸ºæœªæ¥æ‰©å±•åšå¥½å‡†å¤‡ï¼Œå¯ä»¥è½»æ¾æ·»åŠ ï¼š

- RSS feed é…ç½®
- Sitemap é…ç½®
- æœç´¢åŠŸèƒ½é…ç½®
- è¯„è®ºç³»ç»Ÿé…ç½®
- å›¾ç‰‡å¤„ç†é…ç½®
- å¤šè¯­è¨€æ”¯æŒé…ç½®

åªéœ€åœ¨ `config_models.py` ä¸­æ·»åŠ æ–°çš„é…ç½®æ¨¡å‹ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨éªŒè¯å’Œä½¿ç”¨ã€‚

## æ€»ç»“

âœ… é…ç½®ç³»ç»Ÿé›†æˆå®Œæˆ
âœ… æ‰€æœ‰ TODO é¡¹å·²å®Œæˆ
âœ… ä»£ç ç»“æ„æ¸…æ™°ï¼Œç±»å‹å®‰å…¨
âœ… ç”¨æˆ·å¯é€šè¿‡ `config.yaml` å®Œå…¨è‡ªå®šä¹‰åšå®¢å¤–è§‚å’Œè¡Œä¸º
âœ… ç³»ç»Ÿæ˜“äºç»´æŠ¤å’Œæ‰©å±•

ç”¨æˆ·ç°åœ¨å¯ä»¥é€šè¿‡ä¿®æ”¹ `config.yaml` è‡ªç”±å®šåˆ¶åšå®¢çš„å„ä¸ªæ–¹é¢ï¼Œæ— éœ€ä¿®æ”¹ä»»ä½•ä»£ç ï¼
